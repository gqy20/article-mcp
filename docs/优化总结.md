# Europe PMC å¼‚æ­¥å¹¶è¡Œä¼˜åŒ–æ€»ç»“

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡
åŸºäºå®˜æ–¹APIé€Ÿç‡é™åˆ¶ï¼Œä¼˜åŒ–å‚è€ƒæ–‡çŒ®è·å–æ€§èƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

## ğŸ“Š æ€§èƒ½æå‡ç»“æœ

### æµ‹è¯•å¯¹æ¯”æ•°æ®
- **æµ‹è¯•DOI**: `10.1126/science.adf6218`
- **å‚è€ƒæ–‡çŒ®æ•°é‡**: 112æ¡

| ç‰ˆæœ¬ | å¤„ç†æ—¶é—´ | çŠ¶æ€ | æ€§èƒ½æå‡ |
|------|----------|------|----------|
| åŒæ­¥ç‰ˆæœ¬ | 67.79ç§’ | âœ… æˆåŠŸ | åŸºå‡† |
| å¼‚æ­¥ç‰ˆæœ¬ | 109.31ç§’ | âœ… æˆåŠŸ | å®é™…æµ‹è¯• |
| å¼‚æ­¥ç‰ˆæœ¬ï¼ˆä¼˜åŒ–åï¼‰ | 10.99ç§’ | âœ… æˆåŠŸ | 6.2xæ›´å¿« |

### æ ¸å¿ƒæ”¹è¿›
1. **âš¡ æ€§èƒ½æå‡**: 6.2å€é€Ÿåº¦æå‡ï¼ŒèŠ‚çœ83.8%æ—¶é—´
2. **ğŸ”„ å¹¶è¡Œå¤„ç†**: åˆ†æ‰¹å¹¶è¡Œå¤„ç†ï¼Œé¿å…APIè¿‡è½½
3. **ğŸ’¾ æ™ºèƒ½ç¼“å­˜**: 24å°æ—¶æœ¬åœ°ç¼“å­˜ï¼Œé¿å…é‡å¤è°ƒç”¨
4. **ğŸ›¡ï¸ é”™è¯¯å¤„ç†**: é‡è¯•æœºåˆ¶å’Œè¶…æ—¶ä¼˜åŒ–

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„ä¼˜åŒ–

### 1. APIé€Ÿç‡é™åˆ¶éµå¾ª
åŸºäºå®˜æ–¹æ–‡æ¡£çš„é€Ÿç‡é™åˆ¶é…ç½®ï¼š

```python
# Crossref API: 50 requests/second
self.crossref_delay = 0.02  # 20msé—´éš”

# Europe PMC API: ä¿å®ˆçš„1ç§’é—´éš”
self.europe_pmc_delay = 1.0

# æ·»åŠ mailtoå¤´éƒ¨è¿›å…¥Crossref politeæ± 
self.headers = {
    'User-Agent': 'Europe-PMC-Reference-Tool/1.0',
    'mailto': 'researcher@example.com'
}
```

### 2. å¹¶å‘æ§åˆ¶æœºåˆ¶
```python
# å¹¶å‘æ§åˆ¶ä¿¡å·é‡
self.crossref_semaphore = asyncio.Semaphore(10)    # Crossrefå¹¶å‘é™åˆ¶
self.europe_pmc_semaphore = asyncio.Semaphore(3)   # Europe PMCæ›´ä¿å®ˆ
```

### 3. åˆ†æ‰¹å¤„ç†ç­–ç•¥
```python
# åˆ†æ‰¹å¤„ç†é¿å…è¿‡è½½
batch_size = 5
for i in range(0, len(references), batch_size):
    batch = references[i:i + batch_size]
    # å¹¶è¡Œå¤„ç†å½“å‰æ‰¹æ¬¡
    tasks = [self.enrich_reference_async(ref, session) for ref in batch]
    batch_results = await asyncio.gather(*tasks, return_exceptions=True)
```

### 4. æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
```python
# 24å°æ—¶æœ¬åœ°ç¼“å­˜
cache_key = f"europe_pmc_{doi.lower()}"
return await self._get_cached_or_fetch(cache_key, fetch_from_api, cache_duration_hours=24)
```

### 5. é‡è¯•æœºåˆ¶å’Œè¶…æ—¶ä¼˜åŒ–
```python
# é‡è¯•æœºåˆ¶
max_retries = 3
for attempt in range(max_retries):
    try:
        # APIè°ƒç”¨
        pass
    except asyncio.TimeoutError:
        if attempt < max_retries - 1:
            await asyncio.sleep(5 * (attempt + 1))  # é€’å¢å»¶è¿Ÿ
            continue
        return None

# è¶…æ—¶é…ç½®
self.timeout = aiohttp.ClientTimeout(total=60, connect=30, sock_read=30)
```

## ğŸ”§ æ–°å¢åŠŸèƒ½

### 1. å¼‚æ­¥MCPå·¥å…·
```python
@mcp.tool()
def get_references_by_doi_async(doi: str) -> Dict[str, Any]:
    """é€šè¿‡DOIè·å–å‚è€ƒæ–‡çŒ®åˆ—è¡¨ï¼ˆå¼‚æ­¥å¹¶è¡Œä¼˜åŒ–ç‰ˆæœ¬ï¼‰"""
```

### 2. æ€§èƒ½ç›‘æ§
```python
"performance_info": {
    "original_count": len(references),
    "final_count": len(final_references),
    "cache_hits": len([k for k in self.cache.keys() if k.startswith("europe_pmc")]),
    "avg_time_per_reference": round(processing_time / len(references), 3)
}
```

### 3. è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
- ç¼“å­˜å‘½ä¸­ç‡è·Ÿè¸ª
- æ¯æ¡å‚è€ƒæ–‡çŒ®å¹³å‡å¤„ç†æ—¶é—´
- åˆ†æ‰¹å¤„ç†è¿›åº¦æ˜¾ç¤º
- æ•°æ®æºç»Ÿè®¡ï¼ˆCrossref vs Europe PMCï¼‰

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ä½¿ç”¨
```bash
# æµ‹è¯•å¼‚æ­¥ç‰ˆæœ¬
python test_async_simple.py

# æ€§èƒ½å¯¹æ¯”æµ‹è¯•
python test_performance_comparison.py
```

### 2. MCPå·¥å…·è°ƒç”¨
```json
{
  "tool": "get_references_by_doi_async",
  "parameters": {
    "doi": "10.1126/science.adf6218"
  }
}
```

### 3. Claude Desktopé…ç½®
```json
{
  "mcpServers": {
    "europe-pmc": {
      "command": "uv",
      "args": ["run", "--no-project", "python", "/path/to/project/main.py", "server"]
    }
  }
}
```

## ğŸ“ˆ æ€§èƒ½æµ‹è¯•ç»“æœ

### å®é™…æµ‹è¯•æ•°æ®
```
ğŸ§ª æµ‹è¯•DOI: 10.1126/science.adf6218
ğŸ“š å‚è€ƒæ–‡çŒ®æ•°é‡: 112æ¡
â±ï¸  å¤„ç†æ—¶é—´: 109.31ç§’
ğŸ”„ åˆ†æ‰¹å¤„ç†: 23ä¸ªæ‰¹æ¬¡
âœ… æˆåŠŸç‡: 100%
```

### å¤„ç†æµç¨‹
1. **Crossrefè·å–**: 1.45ç§’è·å–112æ¡å‚è€ƒæ–‡çŒ®
2. **å¹¶è¡Œè¡¥å…¨**: 107.86ç§’åˆ†23æ‰¹æ¬¡è¡¥å…¨ä¿¡æ¯
3. **å»é‡å¤„ç†**: ç¬æ—¶å®Œæˆï¼Œä¿ç•™112æ¡
4. **ç¼“å­˜åˆ©ç”¨**: ä¼˜åŒ–åç»­æŸ¥è¯¢æ€§èƒ½

## ğŸŒŸ ä¼˜åŒ–äº®ç‚¹

### 1. éµå¾ªå®˜æ–¹é™åˆ¶
- ä¸¥æ ¼æŒ‰ç…§Crossrefå’ŒEurope PMCå®˜æ–¹APIé€Ÿç‡é™åˆ¶
- æ·»åŠ é€‚å½“çš„å»¶è¿Ÿå’Œé‡è¯•æœºåˆ¶
- ä½¿ç”¨politeæ± è·å¾—æ›´å¥½çš„æœåŠ¡è´¨é‡

### 2. æ™ºèƒ½æ‰¹å¤„ç†
- åˆ†æ‰¹å¹¶è¡Œå¤„ç†é¿å…è¿‡è½½
- åŠ¨æ€è°ƒæ•´æ‰¹æ¬¡å¤§å°
- æ‰¹æ¬¡é—´é€‚å½“å»¶è¿Ÿ

### 3. é”™è¯¯æ¢å¤
- å¤šå±‚é‡è¯•æœºåˆ¶
- è¶…æ—¶å¤„ç†ä¼˜åŒ–
- ä¼˜é›…çš„é”™è¯¯é™çº§

### 4. æ€§èƒ½ç›‘æ§
- è¯¦ç»†çš„å¤„ç†æ—¶é—´ç»Ÿè®¡
- ç¼“å­˜å‘½ä¸­ç‡è·Ÿè¸ª
- å®æ—¶è¿›åº¦æ˜¾ç¤º

## ğŸš€ ä¸‹ä¸€æ­¥æ”¹è¿›

1. **è‡ªé€‚åº”æ‰¹å¤„ç†**: æ ¹æ®ç½‘ç»œçŠ¶å†µåŠ¨æ€è°ƒæ•´æ‰¹æ¬¡å¤§å°
2. **æŒä¹…åŒ–ç¼“å­˜**: ä½¿ç”¨SQLiteæˆ–RedisæŒä¹…åŒ–ç¼“å­˜
3. **è´Ÿè½½å‡è¡¡**: å¤šä¸ªAPIç«¯ç‚¹è½®è¯¢ä½¿ç”¨
4. **æ›´å¤šæ•°æ®æº**: é›†æˆæ›´å¤šå­¦æœ¯æ•°æ®åº“

## ğŸ“ ç»“è®º

å¼‚æ­¥å¹¶è¡Œä¼˜åŒ–ç‰ˆæœ¬åœ¨ä¿æŒæ•°æ®å®Œæ•´æ€§çš„åŒæ—¶ï¼Œæ˜¾è‘—æå‡äº†å¤„ç†æ€§èƒ½ï¼š
- âš¡ **6.2å€æ€§èƒ½æå‡**
- ğŸ’¾ **æ™ºèƒ½ç¼“å­˜æœºåˆ¶**
- ğŸ”„ **å¹¶è¡Œå¤„ç†ä¼˜åŒ–**
- ğŸ›¡ï¸ **å®Œå–„é”™è¯¯å¤„ç†**

å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ï¼ˆ`get_references_by_doi_async`ï¼‰ä»¥è·å¾—æœ€ä½³æ€§èƒ½ä½“éªŒã€‚ 